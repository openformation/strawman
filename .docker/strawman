#!/usr/bin/env bash

STRAWMAN_DIR=/app

STRAWMAN_PORT=${STRAWMAN_PORT:"8080"}
STRAWMAN_ENDPOINT=https://openformation.io
STRAWMAN_WORKSPACE_DIR=/strawman
STRAWMAN_SNAPSHOT_DIR=/strawman/snapshots
STRAWMAN_DENO_PERMISSIONS=${STRAWMAN_DENO_PERMISSIONS:="--allow-net --allow-read=$STRAWMAN_WORKSPACE_DIR,$STRAWMAN_SNAPSHOT_DIR --allow-write=$STRAWMAN_SNAPSHOT_DIR"}

cd $STRAWMAN_DIR

chown $(id -u):$(id -g) -R $STRAWMAN_WORKSPACE_DIR

args="$@"
deno run $STRAWMAN_DENO_PERMISSIONS modules/strawman-cli/cli.ts $args -s $STRAWMAN_SNAPSHOT_DIR